
id: Unauthenticated Stored XSS

info:
  name: Unauthenticated Stored XSS in WordPress Admin Panel
  author: Sergey Ryadinsky
  severity: high
  description: Every WordPress Panel below version 5.6.2 is vulnerable to Unauthenticated Stored XSS.
  reference:
    - https://wpscan.com/vulnerability/1a5c5df1-57ee-4190-a336-b0266962078f/
  tags:
    - wordpress
    - vulnerability
    - xss

requests:
  - method: GET
    path:
      - "{{BaseURL}}/readme.html"
      - "{{BaseURL}}/"
      - "{{BaseURL}}/wp-content/themes/{{theme}}/style.css"

    extractors:
      - type: regex
        part: body
        group: 1
        regex:
          - "WordPress ([0-9]+\\.[0-9]+\\.[0-9]+)"
          - "<meta name=\"generator\" content=\"WordPress ([0-9]+\\.[0-9]+\\.[0-9]+)\" />"
          - "Version: ([0-9]+\\.[0-9]+\\.[0-9]+)"

    matchers-condition: or
    matchers:
      - type: word
        words:
          - "WordPress"
        part: body

      - type: regex
        regex:
          # Match any WordPress version less than 6.5.2
          - "^([0-5]\\.[0-9]+\\.[0-9]+|6\\.[0-4]\\.[0-9]+|6\\.5\\.[0-1])$"
        part: extract
        condition: and
        name: vulnerable_version_detected

    classifiers:
      - type: dsl
        dsl:
          - "contains(body, 'WordPress') && !contains(body, '/wp-admin/')"